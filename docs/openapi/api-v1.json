{
  "openapi": "3.1.0",
  "info": {
    "title": "Emailbox API",
    "version": "1.0.0",
    "description": "Emailbox API v1 contract. Includes current routable v1 JSON endpoints and custom actions."
  },
  "servers": [
    {
      "url": "/"
    }
  ],
  "security": [
    {
      "ApiTokenAuth": []
    }
  ],
  "tags": [
    {
      "name": "Auth",
      "description": "Authentication and session operations"
    },
    {
      "name": "Me",
      "description": "Current-user identity operations"
    },
    {
      "name": "Accounts",
      "description": "Account list endpoint"
    },
    {
      "name": "Inboxes",
      "description": "Inbox and inbox-scoped endpoints"
    },
    {
      "name": "Drafts",
      "description": "Draft CRUD and send operations"
    },
    {
      "name": "Emails",
      "description": "Email lookup and message actions"
    },
    {
      "name": "Labels",
      "description": "Mailbox/system labels"
    },
    {
      "name": "Webhook Subscriptions",
      "description": "Webhook subscriptions lifecycle"
    },
    {
      "name": "Custom Domains",
      "description": "Custom domain verification and management"
    },
    {
      "name": "Threads",
      "description": "Threaded inbox views"
    },
    {
      "name": "Utilities",
      "description": "Utility endpoints"
    }
  ],
  "paths": {
    "/api/v1/auth": {
      "post": {
        "tags": ["Auth"],
        "summary": "Create API token",
        "security": [],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["email", "password"],
                "properties": {
                  "email": {
                    "type": "string"
                  },
                  "password": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Authenticated token response",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/AuthResponse"
                }
              }
            }
          },
          "401": {
            "description": "Invalid credentials",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Auth"],
        "summary": "Revoke API token",
        "responses": {
          "200": {
            "description": "Token revoked",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/me": {
      "get": {
        "tags": ["Me"],
        "summary": "Get current user",
        "responses": {
          "200": {
            "description": "Current user",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/User"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/password": {
      "patch": {
        "tags": ["Auth"],
        "summary": "Update current user password",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["user"],
                "properties": {
                  "user": {
                    "type": "object",
                    "required": ["current_password", "password", "password_confirmation"],
                    "properties": {
                      "current_password": {
                        "type": "string"
                      },
                      "password": {
                        "type": "string"
                      },
                      "password_confirmation": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "422": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Auth"],
        "summary": "Update current user password",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["user"],
                "properties": {
                  "user": {
                    "type": "object",
                    "required": ["current_password", "password", "password_confirmation"],
                    "properties": {
                      "current_password": {
                        "type": "string"
                      },
                      "password": {
                        "type": "string"
                      },
                      "password_confirmation": {
                        "type": "string"
                      }
                    }
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Password updated",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          },
          "422": {
            "description": "Validation error",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/accounts": {
      "get": {
        "tags": ["Accounts"],
        "summary": "List accounts for current user",
        "responses": {
          "200": {
            "description": "Accounts",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Account"
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/inboxes": {
      "get": {
        "tags": ["Inboxes"],
        "summary": "List inboxes",
        "parameters": [
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "per_page",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Inbox list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InboxList"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Inboxes"],
        "summary": "Create inbox",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/InboxCreate"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Inbox created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Inbox"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "403": {
            "description": "Plan limit reached",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/inboxes/{id}": {
      "get": {
        "tags": ["Inboxes"],
        "summary": "Get inbox and latest emails",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "labels",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Inbox details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/InboxEmails"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Inbox not found"
          }
        }
      },
      "delete": {
        "tags": ["Inboxes"],
        "summary": "Delete inbox",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Inbox not found"
          }
        }
      }
    },
    "/api/v1/inboxes/{id}/warmup": {
      "get": {
        "tags": ["Inboxes"],
        "summary": "Get inbox warmup status",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Warmup status",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WarmupStatus"
                }
              }
            }
          },
          "404": {
            "description": "Inbox not found"
          }
        }
      }
    },
    "/api/v1/inboxes/{id}/stream": {
      "get": {
        "tags": ["Inboxes"],
        "summary": "SSE stream for inbox",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "timeout",
            "in": "query",
            "required": false,
            "schema": {
              "type": "integer"
            }
          },
          {
            "name": "since",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string",
              "format": "date-time"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Server-sent events stream",
            "content": {
              "text/event-stream": {
                "schema": {
                  "type": "string"
                }
              }
            }
          },
          "503": {
            "description": "Too many concurrent streams",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Error"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/inboxes/{inbox_id}/drafts": {
      "get": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "List drafts in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Drafts list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DraftCollection"
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        }
      },
      "post": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Create draft in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Draft created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameter"
          }
        }
      }
    },
    "/api/v1/inboxes/{inbox_id}/drafts/{id}": {
      "get": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Get draft in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "404": {
            "description": "Draft not found"
          }
        }
      },
      "patch": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Update draft in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "404": {
            "description": "Draft not found"
          }
        }
      },
      "put": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Update draft in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "404": {
            "description": "Draft not found"
          }
        }
      },
      "delete": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Delete draft in inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          },
          "404": {
            "description": "Draft not found"
          }
        }
      }
    },
    "/api/v1/inboxes/{inbox_id}/drafts/{id}/send": {
      "post": {
        "tags": ["Drafts", "Inboxes"],
        "summary": "Send draft from inbox",
        "parameters": [
          {
            "name": "inbox_id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Draft sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResult"
                }
              }
            }
          },
          "429": {
            "description": "Plan limit reached"
          }
        }
      }
    },
    "/api/v1/drafts": {
      "get": {
        "tags": ["Drafts"],
        "summary": "List drafts across inboxes",
        "responses": {
          "200": {
            "description": "Drafts list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/DraftCollection"
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Drafts"],
        "summary": "Create draft (inbox required)",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Draft created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "400": {
            "description": "Invalid parameter"
          }
        }
      }
    },
    "/api/v1/drafts/{id}": {
      "get": {
        "tags": ["Drafts"],
        "summary": "Get draft",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          },
          "404": {
            "description": "Draft not found"
          }
        }
      },
      "patch": {
        "tags": ["Drafts"],
        "summary": "Update draft",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Drafts"],
        "summary": "Update draft",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/DraftInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated draft",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Draft"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Drafts"],
        "summary": "Delete draft",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          }
        }
      }
    },
    "/api/v1/drafts/{id}/send": {
      "post": {
        "tags": ["Drafts"],
        "summary": "Send draft",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Draft sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResult"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/emails": {
      "get": {
        "tags": ["Emails"],
        "summary": "List emails in inbox",
        "parameters": [
          {
            "name": "inbox",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "cursor",
            "in": "query",
            "required": false,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Emails list",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailList"
                }
              }
            }
          },
          "422": {
            "description": "Missing inbox"
          }
        }
      },
      "post": {
        "tags": ["Emails"],
        "summary": "Ingest inbound email payload",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "additionalProperties": true
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Email accepted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "job": {
                      "type": "string"
                    }
                  }
                }
              }
            }
          },
          "401": {
            "description": "Unauthorized"
          }
        }
      }
    },
    "/api/v1/emails/{id}": {
      "patch": {
        "tags": ["Emails"],
        "summary": "Update email labels",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailLabelPatch"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated email",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Email"
                }
              }
            }
          },
          "404": {
            "description": "Email not found"
          }
        }
      },
      "put": {
        "tags": ["Emails"],
        "summary": "Update email labels",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailLabelPatch"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated email",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Email"
                }
              }
            }
          },
          "404": {
            "description": "Email not found"
          }
        }
      }
    },
    "/api/v1/emails/{id}/actions": {
      "patch": {
        "tags": ["Emails"],
        "summary": "Apply actions on an email",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailActionInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated email",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/Email"
                }
              }
            }
          },
          "400": {
            "description": "Invalid action payload"
          }
        }
      }
    },
    "/api/v1/emails/{id}/reply": {
      "post": {
        "tags": ["Emails"],
        "summary": "Reply to an email",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailSendInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Reply sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResult"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/emails/{id}/forward": {
      "post": {
        "tags": ["Emails"],
        "summary": "Forward an email",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailSendInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Forward sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResult"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/emails/send": {
      "post": {
        "tags": ["Emails"],
        "summary": "Send outbound email",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/EmailSendInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Outbound email sent",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/SendResult"
                }
              }
            }
          },
          "400": {
            "description": "Missing or invalid fields"
          },
          "429": {
            "description": "Plan limit reached"
          }
        }
      }
    },
    "/api/v1/emails/search": {
      "get": {
        "tags": ["Emails"],
        "summary": "Search emails",
        "parameters": [
          {
            "name": "q",
            "in": "query",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Search results",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailList"
                }
              }
            }
          },
          "400": {
            "description": "Missing search query"
          }
        }
      }
    },
    "/api/v1/mailbox_labels": {
      "get": {
        "tags": ["Labels"],
        "summary": "List mailbox labels",
        "responses": {
          "200": {
            "description": "Labels",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/MailboxLabel"
                      }
                    }
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Labels"],
        "summary": "Create mailbox label",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MailboxLabelInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Label created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MailboxLabel"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/mailbox_labels/{id}": {
      "patch": {
        "tags": ["Labels"],
        "summary": "Update mailbox label",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MailboxLabelInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated label",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MailboxLabel"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Labels"],
        "summary": "Update mailbox label",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/MailboxLabelInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated label",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/MailboxLabel"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Labels"],
        "summary": "Delete mailbox label",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          }
        }
      }
    },
    "/api/v1/notification_tokens": {
      "post": {
        "tags": ["Utilities"],
        "summary": "Create notification token",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["token", "platform"],
                "properties": {
                  "token": {
                    "type": "string"
                  },
                  "platform": {
                    "type": "string"
                  }
                }
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Notification token created",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/custom_domains": {
      "get": {
        "tags": ["Custom Domains"],
        "summary": "List custom domains",
        "responses": {
          "200": {
            "description": "Custom domains",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/CustomDomain"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Custom Domains"],
        "summary": "Create custom domain",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomDomainInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Custom domain created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomDomain"
                }
              }
            }
          },
          "403": {
            "description": "Plan limit reached"
          }
        }
      }
    },
    "/api/v1/custom_domains/{id}": {
      "get": {
        "tags": ["Custom Domains"],
        "summary": "Get custom domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Custom domain",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomDomain"
                }
              }
            }
          },
          "404": {
            "description": "Not found"
          }
        }
      },
      "patch": {
        "tags": ["Custom Domains"],
        "summary": "Update custom domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomDomainInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated domain",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomDomain"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Custom Domains"],
        "summary": "Update custom domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/CustomDomainInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated domain",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/CustomDomain"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Custom Domains"],
        "summary": "Delete custom domain",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          }
        }
      }
    },
    "/api/v1/custom_domains/{id}/verify": {
      "post": {
        "tags": ["Custom Domains"],
        "summary": "Verify custom domain records",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Verification result",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "additionalProperties": true
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/webhook_subscriptions": {
      "get": {
        "tags": ["Webhook Subscriptions"],
        "summary": "List webhook subscriptions",
        "responses": {
          "200": {
            "description": "Webhook subscriptions",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/WebhookSubscription"
                  }
                }
              }
            }
          }
        }
      },
      "post": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Create webhook subscription",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookSubscriptionInput"
              }
            }
          }
        },
        "responses": {
          "201": {
            "description": "Webhook subscription created",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/webhook_subscriptions/{id}": {
      "get": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Get webhook subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
                       "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Subscription",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          }
        }
      },
      "patch": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Update webhook subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookSubscriptionInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated subscription",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          }
        }
      },
      "put": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Update webhook subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/WebhookSubscriptionInput"
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Updated subscription",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/WebhookSubscription"
                }
              }
            }
          }
        }
      },
      "delete": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Delete webhook subscription",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "204": {
            "description": "Deleted"
          }
        }
      }
    },
    "/api/v1/webhook_subscriptions/{id}/test": {
      "post": {
        "tags": ["Webhook Subscriptions"],
        "summary": "Send test webhook event",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Test event queued",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "success": {
                      "type": "boolean"
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/email_threads": {
      "get": {
        "tags": ["Threads"],
        "summary": "List threads",
        "responses": {
          "200": {
            "description": "Threads list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "data": {
                      "type": "array",
                      "items": {
                        "$ref": "#/components/schemas/EmailThread"
                      }
                    },
                    "meta": {
                      "type": "object",
                      "additionalProperties": true
                    }
                  }
                }
              }
            }
          }
        }
      }
    },
    "/api/v1/email_threads/{id}": {
      "get": {
        "tags": ["Threads"],
        "summary": "Get thread",
        "parameters": [
          {
            "name": "id",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Thread details",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/EmailThread"
                }
              }
            }
          }
        }
      }
    }
  },
  "components": {
    "securitySchemes": {
      "ApiTokenAuth": {
        "type": "apiKey",
        "in": "header",
        "name": "Authorization",
        "description": "Use `token <value>` or `Bearer <value>`"
      }
    },
    "schemas": {
      "Error": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "error": {
            "type": "string"
          },
          "error_code": {
            "type": "string"
          }
        }
      },
      "AuthResponse": {
        "type": "object",
        "additionalProperties": false,
        "properties": {
          "token": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "expires_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        },
        "required": ["token"]
      },
      "User": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "integer"
          },
          "email": {
            "type": "string"
          },
          "first_name": {
            "type": "string"
          },
          "last_name": {
            "type": "string"
          }
        }
      },
      "Account": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "integer"
          },
          "name": {
            "type": "string"
          }
        }
      },
      "Inbox": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "email_address": {
            "type": "string"
          },
          "is_disabled": {
            "type": "boolean"
          },
          "api_created": {
            "type": "boolean"
          }
        }
      },
      "InboxCreate": {
        "type": "object",
        "additionalProperties": true,
        "required": ["name"],
        "properties": {
          "name": {
            "type": "string"
          },
          "custom_domain_id": {
            "type": "string"
          }
        }
      },
      "InboxEmails": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "emails": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Email"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Email"
            }
          }
        }
      },
      "InboxList": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Inbox"
            }
          }
        }
      },
      "Email": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "from_address": {
            "type": "string"
          },
          "to_address": {
            "type": "string"
          },
          "subject": {
            "type": "string"
          },
          "labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "created_at": {
            "type": "string"
          },
          "updated_at": {
            "type": "string"
          }
        }
      },
      "EmailList": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "emails": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Email"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Email"
            }
          },
          "meta": {
            "type": "object",
            "additionalProperties": true
          }
        }
      },
      "EmailLabelPatch": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "add_labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "remove_labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          }
        }
      },
      "EmailActionInput": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "add_labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "remove_labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "labels": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "mark_read": {
            "type": "boolean"
          },
          "move_to": {
            "type": "string"
          }
        }
      },
      "EmailSendInput": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "to": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "subject": {
            "type": "string"
          },
          "text_body": {
            "type": "string"
          },
          "html_body": {
            "type": "string"
          },
          "inbox_id": {
            "type": "string"
          },
          "message_type": {
            "type": "string"
          }
        }
      },
      "Draft": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "inbox_id": {
            "type": "string"
          },
          "subject": {
            "type": "string"
          },
          "to": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "to_address": {
            "type": "string"
          },
          "status": {
            "type": "string"
          }
        }
      },
      "DraftInput": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "to": {
            "oneOf": [
              {
                "type": "string"
              },
              {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            ]
          },
          "subject": {
            "type": "string"
          },
          "text_body": {
            "type": "string"
          },
          "html_body": {
            "type": "string"
          }
        }
      },
      "DraftCollection": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "count": {
            "type": "integer"
          },
          "drafts": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Draft"
            }
          },
          "data": {
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/Draft"
            }
          }
        }
      },
      "MailboxLabel": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "color": {
            "type": "string"
          },
          "system": {
            "type": "boolean"
          }
        }
      },
      "MailboxLabelInput": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "name": {
            "type": "string"
          },
          "slug": {
            "type": "string"
          },
          "color": {
            "type": "string"
          }
        }
      },
      "WebhookSubscription": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "url": {
            "type": "string"
          },
          "events": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "active": {
            "type": "boolean"
          },
          "created_at": {
            "type": "string"
          }
        }
      },
      "WebhookSubscriptionInput": {
        "type": "object",
        "required": ["webhook_subscription"],
        "additionalProperties": true,
        "properties": {
          "webhook_subscription": {
            "type": "object",
            "properties": {
              "url": {
                "type": "string"
              },
              "active": {
                "type": "boolean"
              },
              "events": {
                "type": "array",
                "items": {
                  "type": "string"
                }
              }
            }
          }
        }
      },
      "CustomDomain": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "domain": {
            "type": "string"
          },
          "verified_status": {
            "type": "string"
          },
          "dkim_host": {
            "type": "string"
          },
          "dkim_value": {
            "type": "string"
          }
        }
      },
      "CustomDomainInput": {
        "type": "object",
        "required": ["custom_domain"],
        "additionalProperties": true,
        "properties": {
          "custom_domain": {
            "type": "object",
            "required": ["domain"],
            "properties": {
              "domain": {
                "type": "string"
              },
              "dkim_host": {
                "type": "string"
              },
              "dkim_value": {
                "type": "string"
              },
              "spf_host": {
                "type": "string"
              },
              "spf_value": {
                "type": "string"
              }
            }
          }
        }
      },
      "EmailThread": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "thread_id": {
            "type": "string"
          },
          "subject": {
            "type": "string"
          },
          "participants": {
            "type": "array",
            "items": {
              "type": "string"
            }
          },
          "email_count": {
            "type": "integer"
          }
        }
      },
      "WarmupStatus": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "inbox_id": {
            "type": "integer"
          },
          "warmup_started_at": {
            "type": "string",
            "format": "date-time",
            "nullable": true
          }
        }
      },
      "SendResult": {
        "type": "object",
        "additionalProperties": true,
        "properties": {
          "id": {
            "type": "string"
          },
          "message_id": {
            "type": "string"
          },
          "status": {
            "type": "string"
          },
          "provider_message_id": {
            "type": "string"
          }
        }
      }
    }
  }
}
